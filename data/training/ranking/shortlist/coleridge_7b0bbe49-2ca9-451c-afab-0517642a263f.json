{
  "doc_id": "7b0bbe49-2ca9-451c-afab-0517642a263f",
  "query": "What dataset was used in the paper?",
  "k": 50,
  "shortlist": [
    "All code used in this study is available on github (see Data/Code availability).",
    "All data processing, visualization, and analysis was performed using python v3.6.0 or R v4.0.3.",
    "e, Distribution of GISAID samples (March to July 2020) and COG UK samples (April to December 2020) retrieved for this study.",
    "The COG UK data provided a more thorough application of our model as abundant SARS-CoV-2 sequence data was available at a weekly time-scale ( Figure 2b ).",
    "With that said, we analyzed selection across pooled continental or country (UK) data to reduce biases driven by artificial over representation of lineages in specific locales.",
    "e, We compared mutational counts in GISAID data (from January to August 2020) and COG UK data (from March to December 2020).",
    "We used a CNN architecture similar to a previous study 7 .",
    "We only kept samples that were available across both GISAID and COG UK data sources at the time of this study.",
    "To ensure accurate inferences were being made in empirical data, we set a threshold for sample inclusion based on the proportion of genome masked.",
    "We applied our trained and validated CNN/RNN model to empirical global SARS-CoV-2 data from March to July 2020 (GISAID 1 ) and to United Kingdom data from April to December 2020 (COG UK 14 ).",
    "All simulations parameters are provided in Supplementary Table 1 .",
    "In addition, common population genetic statistics, such as Tajima's D 12 (TajD) and Fay and Wu's H 13 (FWuH) can be integrated at the sliding window stage to improve inferences.",
    "To ensure accurate inferences, we applied a conservative filtering step removing any samples with excessive genome masking relative to the overall sample distribution (Supplementary Figure 4 ; see Online Methods).",
    "Following filtering of the data, the GISAID regions of North America, Europe, and Asia had a sufficient (>= 200) number of samples per month between March to July 2020.",
    "All machine learning models were implemented in Keras using tensorflow v2.3.0 or scikit-learn v0.24.0.",
    "In addition, we integrate existing population genetic statistics, such as TajD and FWuH, at the sliding window step to improve model performance by combining multiple features with our CNN estimates.",
    "Finally, to make inferences in full 29903 bp genomes, we performed sliding window analyses across approximately 10,000 simulated genomes and then trained a long short-term memory (LSTM) RNN to predict if the genome was under positive selection and the population fitness (Online Methods).",
    "The majority of sequences corresponded to data obtained from December 2019 to July 2020.",
    "All parameters used for simulations, and a complete simulation overview, are provided in Online Methods c, Positive selection classification performance across individual and combined sliding window features.",
    "Both the continental and the COG UK data profiling is an excellent example of how the simulationbased CNN/RNN tools can track selective differences among viral clones almost in real time.",
    "In addition, we evaluated the performance of bidirectional LSTMs combining CNN estimates with site frequency-based population genetic statistics such as TajD Figure 3) .",
    "We initially evaluated the separability of positive and neutral evolutionary simulations using sitefrequency based summary statistics Tajima's D (TajD) and Fay and Wu's H (FWuH) (Supplementary Figure 1) .",
    "We retained 66,495 samples in our final analysis.",
    "Many population genetic and phylogenetic methods exist to discriminate among multiple evolutionary processes or models, but the majority of methods utilize summary statistics that reduce sequence information into a condensed numerical or graphical output 4, 5 .",
    "The reference ID used to call variants in the COG samples was England/LOND-D51C5/2020 from week 16.",
    "a, For classifying positive selection, we chose the top scoring model based on the F1 score (harmonic mean of precision and recall) in a holdout set of 3000 neutral and 3000 positive selection simulated populations.",
    "After filtering, we retained 28,350 SARS-CoV-2 genome sequences from GISAID and 66,495 from COG UK for analysis ( Figure 1e ).",
    "In particular, we ensured that mutation counts using the LONG-D51C5 reference genome from April 2020 resulted in a smaller number of mutations on average then mutations called in COG UK data using the Wuhan reference from December 2019.",
    "To ensure we were making accurate inferences, we employed a conservative filtering step removing any genomes that appeared to outliers based on the proportion of the genome masked (Supplementary Figure 4) .",
    "We then performed sliding window analysis, with a step size of 50 bp, across both the North America, Europe, and Asia SARS-CoV-2 samples using our combined CNN and LSTM approach.",
    "We found 2500 bp windows with sample (row) sorting to provide a balance between performance, with the population genetic statistics showing separability of neutral vs positive classes (Supplementary Figure 1) , and retention of positional information, and chose this window size for future analysis.",
    "The combined CNN and FWuH model was used for classification of positive selection in empirical data.",
    "f, Comparison of mutations per genome in simulated genomes (1000 genomes x 8000 simulations), GISAID samples (mutations called using Wuhan reference genome), and COG UK samples (mutations called using an England reference genome).",
    "Early applications of deep learning in population genetics have generated accurate predictions of introgression, recombination rate, and selection, but have largely focused on recombining, germ-line data from human populations or single locus analyses 7, [9] [10] [11] .",
    "In addition, as we were looking to analyze positive selection estimates over time, we required 200 samples per time point.",
    "We evaluated multiple genomic, or sliding, window sizes (see Methods) and found a genomic window length of 2500 bp to be sufficient to ensure separability of site frequency distributions from simulated populations subject to neutral or positive selection (Supplementary Figure 1) .",
    "To implement this, we performed sliding window analysis with our CNN across approximately 5000 simulated 29903 bp genomes.",
    "We then aligned each sequence to the Wuhan reference genome (NCBI RefSeq: NC_045512) using a Needleman-Wunsch rapid global alignment implemented in EMBOSS stretcher (default settings).",
    "Because our CNN was trained on alignments of 200 samples or sequences, we required approximately 200 samples per geographic region for analysis.",
    "By pooling SARS-CoV-2 samples across specific geographic regions and time points for analysis, we find evidence for positive selection in all populations but with varying evolutionary fitnesses (fitness ranging from 1.05 to 1.5) in Asia, Europe, and North America from March to July 2020 ( Figure 2a ).",
    "For COG UK data, a, we only accepted samples with less than 1.8% of the genome masked, and b, did not find an excessive number of sites with masking in a genome-wide scan.",
    "In addition to classifying positive selection, we built a model to quantify the evolutionary fitness in empirical data.",
    "Because training on full genome alignments is computationally expensive, information from full genomes can be accounted for by performing sliding window analyses using CNN estimates, P(Sw), and analyzing the sliding window estimates with recurrent neural networks (RNN) such as a long short-term memory (LSTM) network.",
    "Combining CNN and FWuH sliding window estimates resulted in the strongest performance.",
    "The F1 score (harmonic mean of precision and recall) was computed 100 times across subsamples of 100 neutral (n = 3000) and positive (n = 3000) simulated genomes.",
    "We retained 28,350 samples in our final analysis.",
    "As we were interested in studying potential positive selection beyond the time points investigated in the GISAID samples, we selected an England reference genome to call variants using a virus that harboured the known fixed D614G haplotype.",
    "To identify loci subject to positive selection in a non-recombining system, we built a tool combining evolutionary simulations, CNNs, and RNNs to perform sliding window analysis across a genome.",
    "The F1 score was taken as the mean estimate across 100 subsamples of the data where positively selected samples were stratified by fitness.",
    "We called mutations in the GISAID data using the Wuhan reference genome (NCBI RefSeq: NC_045512) to examine positive selection during early expansion of SARS-CoV-2 and called mutations in the COG UK data using a an England reference genome (COG UK: England/LOND-D51C5/2020) from April to study evolution post-fixation of the D614G haplotype 15 ."
  ],
  "embedding_config": {
    "client": "INSTRUCTOR(\n  (0): Transformer({'max_seq_length': 512, 'do_lower_case': False}) with Transformer model: T5EncoderModel \n  (1): Pooling({'word_embedding_dimension': 768, 'pooling_mode_cls_token': False, 'pooling_mode_mean_tokens': True, 'pooling_mode_max_tokens': False, 'pooling_mode_mean_sqrt_len_tokens': False, 'pooling_mode_weightedmean_tokens': False, 'pooling_mode_lasttoken': False})\n  (2): Dense({'in_features': 1024, 'out_features': 768, 'bias': False, 'activation_function': 'torch.nn.modules.linear.Identity'})\n  (3): Normalize()\n)",
    "model_name": "hkunlp/instructor-large",
    "cache_folder": null,
    "model_kwargs": {},
    "embed_instruction": "Represent the sentence for retrieval optimized for answering questions on the mention of data; Input: ",
    "query_instruction": "Represent the question for retrieving the most relevant sentence mentioning data; Input: "
  },
  "vectorstore_cls": "Qdrant",
  "doc_options": {
    "skip_urls": true,
    "min_sentence_len": 25
  }
}